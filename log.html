<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·¥ç¨‹æ–½å·¥æ—¥èªŒç”Ÿæˆå™¨</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root { --primary-color: #2980b9; --secondary-color: #2c3e50; --bg-color: #ecf0f1; }
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: var(--bg-color); margin: 0; padding: 20px; display: flex; gap: 20px; justify-content: center; min-height: 100vh; box-sizing: border-box; }
        
        /* å·¦å´æ“ä½œå€ */
        .controls { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); width: 320px; height: fit-content; }
        .controls h2 { color: var(--secondary-color); border-bottom: 2px solid var(--primary-color); padding-bottom: 10px; margin-top: 0; }
        
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: bold; color: #555; }
        .input-group input, .input-group select, .input-group textarea { width: 100%; padding: 10px; border: 1px solid #bdc3c7; border-radius: 5px; box-sizing: border-box; font-size: 16px; }
        
        .file-upload { border: 2px dashed #bdc3c7; padding: 15px; text-align: center; cursor: pointer; border-radius: 5px; margin-bottom: 5px; background: #f9f9f9; transition: 0.3s; }
        .file-upload:hover { background: #eef2f3; border-color: var(--primary-color); }
        
        button { background-color: var(--primary-color); color: white; border: none; padding: 12px; border-radius: 5px; cursor: pointer; width: 100%; font-size: 16px; font-weight: bold; margin-top: 10px; }
        button:hover { background-color: #3498db; }
        .btn-download { background-color: #27ae60; margin-top: 20px; }
        .btn-download:hover { background-color: #2ecc71; }

        /* å³å´é è¦½å€ (A4 æ¨£å¼) */
        .preview-area { flex: 1; display: flex; justify-content: center; background: #95a5a6; padding: 20px; border-radius: 8px; overflow-y: auto; }
        #log-paper {
            background: white; width: 210mm; min-height: 297mm; padding: 15mm; box-shadow: 0 0 15px rgba(0,0,0,0.2); box-sizing: border-box; position: relative;
            display: flex; flex-direction: column;
        }

        /* æ—¥èªŒå…§å®¹æ¨£å¼ */
        .header { text-align: center; border-bottom: 3px double var(--secondary-color); padding-bottom: 15px; margin-bottom: 20px; }
        .header h1 { margin: 0; color: var(--secondary-color); font-size: 28px; }
        .header h3 { margin: 5px 0; color: var(--primary-color); font-size: 20px; }
        .header p { margin: 5px 0; font-size: 12px; color: #7f8c8d; }

        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; border: 1px solid #bdc3c7; padding: 15px; border-radius: 5px; background: #fdfdfd; }
        .info-item strong { display: block; color: var(--secondary-color); font-size: 14px; margin-bottom: 3px; }
        .info-item span { color: #333; font-size: 16px; border-bottom: 1px solid #eee; display: block; padding-bottom: 2px; }

        .photo-section { display: flex; flex-direction: column; gap: 20px; flex: 1; }
        .photo-box { border: 1px solid #bdc3c7; padding: 10px; border-radius: 5px; background: #fff; }
        .photo-title { background: var(--secondary-color); color: white; padding: 5px 10px; display: inline-block; border-radius: 3px; font-size: 14px; margin-bottom: 10px; }
        .photo-frame { width: 100%; height: 300px; background-color: #ecf0f1; display: flex; align-items: center; justify-content: center; overflow: hidden; border: 1px solid #eee; }
        .photo-frame img { width: 100%; height: 100%; object-fit: contain; }
        .photo-placeholder { color: #bdc3c7; font-size: 14px; }

        .footer { margin-top: auto; border-top: 1px solid #bdc3c7; padding-top: 15px; display: flex; justify-content: space-between; font-size: 14px; color: #333; }
        .sign-area { text-align: center; }
        .sign-line { border-bottom: 1px solid #333; width: 150px; display: inline-block; margin-top: 30px; }

    </style>
</head>
<body>

    <div class="controls">
        <h2>ğŸ—ï¸ æ–½å·¥æ—¥èªŒè¨­å®š</h2>
        
        <div class="input-group">
            <label>æ‰¿æ”¬å» å•†</label>
            <select id="companySelect" onchange="updateView()">
                <option value="åƒå¼˜">åƒå¼˜ç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸</option>
                <option value="äº’æ„›">äº’æ„›ä¼æ¥­è¡Œ</option>
            </select>
        </div>

        <div class="input-group">
            <label>æ¡ˆå ´åç¨± (å­¸æ ¡)</label>
            <input type="text" id="siteName" placeholder="ä¾‹å¦‚ï¼šé‘„å¼·åœ‹å°" oninput="updateView()">
        </div>

        <div class="input-group">
            <label>æ–½å·¥é …ç›® / å…§å®¹</label>
            <input type="text" id="workContent" placeholder="ä¾‹å¦‚ï¼šæ›´æ›æ”€çˆ¬æ¶å®‰å…¨åœ°å¢Š" oninput="updateView()">
        </div>

        <div class="input-group">
            <label>æ–½å·¥äººå“¡</label>
            <input type="text" id="workerName" placeholder="ä¾‹å¦‚ï¼šå·¥å‹™çµ„" oninput="updateView()">
        </div>

        <hr>
        
        <div class="input-group">
            <label>ğŸ“¸ æ–½å·¥å‰ç…§ç‰‡ (Before)</label>
            <div class="file-upload" onclick="document.getElementById('imgInput1').click()">
                é»æ­¤ä¸Šå‚³ã€Œæ–½å·¥å‰ã€ç…§ç‰‡
            </div>
            <input type="file" id="imgInput1" accept="image/*" style="display:none" onchange="loadImg(event, 'preview1')">
        </div>

        <div class="input-group">
            <label>âœ¨ å®Œå·¥å¾Œç…§ç‰‡ (After)</label>
            <div class="file-upload" onclick="document.getElementById('imgInput2').click()">
                é»æ­¤ä¸Šå‚³ã€Œå®Œå·¥å¾Œã€ç…§ç‰‡
            </div>
            <input type="file" id="imgInput2" accept="image/*" style="display:none" onchange="loadImg(event, 'preview2')">
        </div>

        <button class="btn-download" onclick="downloadImage()">ğŸ“¥ ä¸‹è¼‰æ–½å·¥æ—¥èªŒ (åœ–ç‰‡)</button>
    </div>

    <div class="preview-area">
        <div id="log-paper">
            <div class="header">
                <h1 id="comName">åƒå¼˜ç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸</h1>
                <p id="comDetail">å°åŒ—å¸‚å¤§åŒå€é‡æ…¶åŒ—è·¯2æ®µ35è™Ÿ3Fä¹‹2 ï½œ TEL: 02-25527215</p>
                <h3>å·¥ç¨‹æ–½å·¥æ—¥èªŒ / é©—æ”¶å ±å‘Š</h3>
            </div>

            <div class="info-grid">
                <div class="info-item">
                    <strong>æ¡ˆå ´åç¨±ï¼š</strong>
                    <span id="displaySite">å°šæœªè¼¸å…¥</span>
                </div>
                <div class="info-item">
                    <strong>æ–½å·¥æ—¥æœŸï¼š</strong>
                    <span id="displayDate"></span>
                </div>
                <div class="info-item" style="grid-column: span 2;">
                    <strong>æ–½å·¥é …ç›®ï¼š</strong>
                    <span id="displayContent">å°šæœªè¼¸å…¥</span>
                </div>
            </div>

            <div class="photo-section">
                <div class="photo-box">
                    <div class="photo-title" style="background: #e67e22;">æ–½å·¥å‰ (Before)</div>
                    <div class="photo-frame">
                        <img id="preview1" src="" style="display:none">
                        <span class="photo-placeholder" id="ph1">å°šæœªä¸Šå‚³ç…§ç‰‡</span>
                    </div>
                </div>

                <div class="photo-box">
                    <div class="photo-title" style="background: #27ae60;">å®Œå·¥å¾Œ (After)</div>
                    <div class="photo-frame">
                        <img id="preview2" src="" style="display:none">
                        <span class="photo-placeholder" id="ph2">å°šæœªä¸Šå‚³ç…§ç‰‡</span>
                    </div>
                </div>
            </div>

            <div class="footer">
                <div>
                    <strong>å‚™è¨»äº‹é …ï¼š</strong><br>
                    æœ¬å·¥ç¨‹å·²æŒ‰åœ–æ–½å·¥å®Œç•¢ï¼Œä¸¦ç¶“æ¸¬è©¦ç¢ºèªå®‰å…¨ç„¡è™ã€‚
                </div>
                <div class="sign-area">
                    <strong>æ–½å·¥äººå“¡ç°½ç« ï¼š</strong><br>
                    <span id="displayWorker" style="font-size: 16px; font-family: 'Kaushan Script', cursive;"></span><br>
                    <span class="sign-line"></span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ–æ—¥æœŸ
        document.getElementById('displayDate').innerText = new Date().toLocaleDateString('zh-TW');

        // å…¬å¸è³‡æ–™åº«
        const companies = {
            "åƒå¼˜": {
                name: "åƒå¼˜ç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸",
                detail: "å°åŒ—å¸‚å¤§åŒå€é‡æ…¶åŒ—è·¯2æ®µ35è™Ÿ3Fä¹‹2 ï½œ TEL: 02-25527215"
            },
            "äº’æ„›": {
                name: "äº’æ„›ä¼æ¥­è¡Œ",
                detail: "èŠ±è“®å¸‚ä¸­å¼·è¡—102è™Ÿ1F ï½œ TEL: 03-8312980"
            }
        };

        function updateView() {
            // æ›´æ–°æ–‡å­—
            document.getElementById('displaySite').innerText = document.getElementById('siteName').value || 'å°šæœªè¼¸å…¥';
            document.getElementById('displayContent').innerText = document.getElementById('workContent').value || 'å°šæœªè¼¸å…¥';
            document.getElementById('displayWorker').innerText = document.getElementById('workerName').value;

            // æ›´æ–°å…¬å¸æŠ¬é ­
            const selected = document.getElementById('companySelect').value;
            document.getElementById('comName').innerText = companies[selected].name;
            document.getElementById('comDetail').innerText = companies[selected].detail;
        }

        function loadImg(event, previewId) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.getElementById(previewId);
                    img.src = e.target.result;
                    img.style.display = 'block';
                    // éš±è—æç¤ºæ–‡å­—
                    if(previewId === 'preview1') document.getElementById('ph1').style.display = 'none';
                    if(previewId === 'preview2') document.getElementById('ph2').style.display = 'none';
                }
                reader.readAsDataURL(file);
            }
        }

        function downloadImage() {
            const element = document.getElementById("log-paper");
            const originalShadow = element.style.boxShadow;
            element.style.boxShadow = 'none'; // å»é™¤é™°å½±

            html2canvas(element, { scale: 2, useCORS: true }).then(canvas => {
                const link = document.createElement('a');
                const site = document.getElementById('siteName').value || 'æ¡ˆå ´';
                const date = new Date().toISOString().slice(0,10);
                link.download = `æ–½å·¥æ—¥èªŒ_${site}_${date}.png`;
                link.href = canvas.toDataURL();
                link.click();
                element.style.boxShadow = originalShadow; // æ¢å¾©é™°å½±
            });
        }
    </script>
</body>
</html>
